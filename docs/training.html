<!DOCTYPE html>
<html lang="en">
<head>
<title>CADET</title>
<link rel="icon" href="figures/logo.png">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>

<body>
<link rel="stylesheet" href="styles.css">
<!-- <link rel="stylesheet" href="prism.css"> -->

<a href="https://github.com/tomasplsek/CADET"><img src="figures/github.png" style="position: relative; width: 100px; left: 0%; top: 17px; float: right; margin-right: 0px;"></a>

<header><em>Cavity Detection Tool</em>  (CADET)</header>

<img src="figures/CADET.png" style="float: right; width: 290px; padding-right: 120px; position: fixed; left: 78%; top: 21%;">

<div class="sidenav">
<a id="menu" href="index.html">Overview</a>
<a style="color: rgb(20, 97, 179);font-weight: bold;" id="menu" href="training.html">Training</a>
<a id="menu" href="requirements.html">Requirements</a>
<a id="menu" href="usage.html">Usage</a>
<a id="menu" href="example.html">Example</a>
</div>

<main>

<section>

<h1>Training of the CADET pipeline</h1>

<p>
The convolutional neural network was trained on artificial images which were 
produced from generated 3D beta models 
(<a target="_blank" href="https://ui.adsabs.harvard.edu/abs/1978A%26A....70..677C/abstract">Cavaliere et al. 1978</a>) 
into which we randomly inserted ellipsoidal cavities. The parameter ranges and 
distributions used for generating models of galaxies and X-ray cavities were 
estimated from the measurements of nearby galaxies (for more info see the 
<a target="_blank" href="https://github.com/tomasplsek/CADET/blob/main/pdfs/diploma_thesis.pdf">Diploma thesis</a>). 
Besides the cavities, we added also other typical features such as central point sources, 
bright rims around cavities and also antisymmetric spiral perturbations resembling gas 
sloshing (see image below) to imitate the gas distribution of real galaxies. The produced models were summed 
into 2D images a noised using Poisson statistics to resemble real <em>Chandra</em>-like images. 
The corresponding labels were produced similarly by summing the ellipsoidal cavity masks 
into 2D images and binning them to contain either ones (inside the cavity) and zeros (outside of it).
</p>

<br>

<img src="figures/artificial.png" title="Artificial data" style="width: 100%;">

<br>

<p>
We have trained two separate networks using different sets of artificial images:
one purely with galaxies containing cavities (<b><em>CADET_size</em></b>) and the second with
50 percent of galaxies lacking any cavities (<b><em>CADET_search</em></b>). The first network
was further optimized for the proper estimation of cavity sizes, while the second network
was tuned to suppress false positive cavity detections. For both networks, 300 000
artificial images and corresponding labels were generated for training, 10 000 for
validation and 10 000 for testing of the network. Their parameters were drawn from
identical ranges and distributions. Using 64 cores on Intel Xeon Silver 4216 CPU, 
the data generation process took nearly 18 hours. The dataset was generated by the
<code>generator.py</code> script, which loads the distributions of the parameters stored in 
the <code>CADET_size_params.csv</code> and <code>CADET_search_params.csv</code> files and uses the beta
model class in the <code>beta_model.py</code> module. Functions utilized for generation of 
ellipsoids and 3D array rotations contained in the <code>beta_model.py</code> module are inspired 
by the <a target="_blank" href="https://pypi.org/project/pyellipsoid/">pyellipsoid</a> package. 
The networks were trained using the <em>ADaptive Moment Estimation</em> (ADAM) optimizer 
and the minimized loss function was the pixel-wise <b><em>binary cross-entropy</em></b>. 
The pipelines were trained for 5 epochs with 8 images per batch while using all of 
the training images in each epoch. The training was performed using an NVIDIA GPU 
type GeForce RTX 2080 SUPER (8 GiB) and lasted approximately 6 hours for both pipelines.
</p>

</section>

</main>

<footer>
&#169; Tomáš Plšek <span style="font-weight: bolder;">&middot;</span> červenec 2021
</footer>    

</body>

</html>